import{j as e,r as p,h as i}from"./react-igPjiDWs.js";import{D as g,E as f,C as y,c as h}from"./customerService-D3igDjQn.js";import{E as j,q as c}from"./schemas-BZNeO2np.js";import{L as v}from"./index-CJ5WocF5.js";import{c as b}from"./charts-CF39Kqye.js";import{f as P,a as E}from"./format-DFPXa_FT.js";import{R as w,d as x}from"./dashboardService-DNP3qVFN.js";const S={up:"Upward trend",down:"Downward trend",flat:"Flat trend"},C=({metric:s})=>{const d=s.trend==="up"?"text-success":s.trend==="down"?"text-danger":"text-muted";return e.jsxs("article",{className:"rounded-2xl border border-border/70 bg-surface/70 p-5 shadow-card",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.18em] text-muted",children:s.label}),e.jsx("p",{className:"mt-3 font-display text-2xl font-bold",children:P(s.value)}),e.jsxs("p",{className:b("mt-2 text-sm font-medium",d),children:[E(s.delta)," Â· ",S[s.trend]]})]})},D=()=>{const[s,d]=p.useState(1),l=p.useMemo(()=>({...g,pageSize:5,page:s}),[s]),a=i({queryKey:c.kpis,queryFn:x.getKpis}),o=i({queryKey:c.revenue("7d"),queryFn:()=>x.getRevenueSeries("7d")}),r=i({queryKey:c.customers(l),queryFn:()=>h.list(l),placeholderData:n=>n});if(a.isLoading||o.isLoading||r.isLoading)return e.jsx(v,{message:"Preparing your performance snapshot..."});if(a.isError||o.isError||r.isError)return e.jsx(j,{message:"One or more overview panels could not load.",onRetry:()=>{Promise.all([a.refetch(),o.refetch(),r.refetch()])}});const m=a.data,u=o.data,t=r.data;return!m||!u||!t?e.jsx(f,{title:"No data yet",message:"Your dashboard will populate soon."}):e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"grid gap-4 sm:grid-cols-2 xl:grid-cols-4",children:m.map(n=>e.jsx("div",{className:"motion-safe:animate-fade-up",children:e.jsx(C,{metric:n})},n.id))}),e.jsx(w,{points:u,title:"7-day revenue trajectory"}),e.jsxs("section",{children:[e.jsx("h2",{className:"mb-3 font-display text-xl font-semibold",children:"Recently active customers"}),e.jsx(y,{rows:t.items,page:t.page,totalPages:t.totalPages,total:t.total,isFetching:r.isFetching,onPageChange:d})]})]})};export{D as OverviewPage};
